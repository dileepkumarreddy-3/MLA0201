import pandas as pd
import math
data = {
    'Outlook': ['Sunny','Sunny','Overcast','Rain','Rain','Rain','Overcast',
                'Sunny','Sunny','Rain','Sunny','Overcast','Overcast','Rain'],
    'Temperature': ['Hot','Hot','Hot','Mild','Cool','Cool','Mild',
                    'Cool','Mild','Mild','Mild','Hot','Hot','Mild'],
    'Humidity': ['High','High','High','High','Normal','Normal','High',
                 'Normal','Normal','Normal','High','Normal','High','Normal'],
    'Wind': ['Weak','Strong','Weak','Weak','Weak','Strong','Strong',
             'Weak','Weak','Weak','Strong','Strong','Weak','Strong'],
    'PlayTennis': ['No','No','Yes','Yes','Yes','No','Yes',
                    'No','Yes','Yes','No','Yes','Yes','No']
}
df = pd.DataFrame(data)
print("Dataset:\n")
print(df)
def entropy(target_col):
    values = target_col.value_counts()
    entropy_val = 0
    for count in values:
        prob = count / sum(values)
        entropy_val -= prob * math.log2(prob)
    return entropy_val
def information_gain(data, feature, target):
    total_entropy = entropy(data[target])
    values = data[feature].unique()  
    weighted_entropy = 0
    for val in values:
        subset = data[data[feature] == val]
        weighted_entropy += (len(subset) / len(data)) * entropy(subset[target])
    return total_entropy - weighted_entropy
def id3(data, features, target):
    if len(data[target].unique()) == 1:
        return data[target].iloc[0]
    if len(features) == 0:
        return data[target].mode()[0]   
    gains = {feature: information_gain(data, feature, target) for feature in features}
    best_feature = max(gains, key=gains.get)   
    tree = {best_feature: {}    
    for value in data[best_feature].unique():
        subset = data[data[best_feature] == value]
        remaining_features = features.copy()
        remaining_features.remove(best_feature)
        tree[best_feature][value] = id3(subset, remaining_features, target)   
    return tree
features = list(df.columns[:-1])
target = 'PlayTennis'
decision_tree = id3(df, features, target)
print("\nDecision Tree:\n")
print(decision_tree)
def classify(sample, tree):
    for feature in tree:
        value = sample[feature]
        subtree = tree[feature].get(value)
        if isinstance(subtree, dict):
            return classify(sample, subtree)
        else:
            return subtree
new_sample = {
    'Outlook': 'Sunny',
    'Temperature': 'Cool',
    'Humidity': 'High',
    'Wind': 'Strong'
}
prediction = classify(new_sample, decision_tree)
print("\nNew Sample:", new_sample)
print("Prediction:", prediction)
#OUTPUT
Dataset:

     Outlook Temperature Humidity    Wind PlayTennis
0      Sunny         Hot     High    Weak         No
1      Sunny         Hot     High  Strong         No
2   Overcast         Hot     High    Weak        Yes
3       Rain        Mild     High    Weak        Yes
4       Rain        Cool   Normal    Weak        Yes
5       Rain        Cool   Normal  Strong         No
6   Overcast        Mild     High  Strong        Yes
7      Sunny        Cool   Normal    Weak         No
8      Sunny        Mild   Normal    Weak        Yes
9       Rain        Mild   Normal    Weak        Yes
10     Sunny        Mild     High  Strong         No
11  Overcast         Hot   Normal  Strong        Yes
12  Overcast         Hot     High    Weak        Yes
13      Rain        Mild   Normal  Strong         No

Decision Tree:

{'Outlook': {'Sunny': {'Temperature': {'Hot': 'No', 'Cool': 'No', 'Mild': {'Humidity': {'Normal': 'Yes', 'High': 'No'}}}}, 'Overcast': 'Yes', 'Rain': {'Wind': {'Weak': 'Yes', 'Strong': 'No'}}}}

New Sample: {'Outlook': 'Sunny', 'Temperature': 'Cool', 'Humidity': 'High', 'Wind': 'Strong'}
Prediction: No
